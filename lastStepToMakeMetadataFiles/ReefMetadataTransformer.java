import java.io.File;

import immutable.util.Text;
import mutable.util.Files;

/*Example input, from file GeneReef_S95E3_(mob) _small.cardanoPROBABLYFITS.json :
{"721":{"ce429b833be000d4da1cc9bb63104cba87533b86109d28b0185b6997":{"GeneReef0934":{"backgroundColor":"#032b31","colorSeed":"9496740817046","files":[{"mediaType":"text/html","name":"GeneReef0934","src":["data:text/html,<html><head><script>let%20code='%5c'use%20strict%","5c';bUo={jH:%5c'(en,dist,pdist)=>{%20let%20x%20=%200mSp%20=%20om","Snd%20=%20p.eDmSnear%20=%20uC(-5*(dist-nd));%20if(dist%20>%20qGe","Fo.lTpTqG;eFo.mQ*nearpTpvYcV%20=%20p.cV;eFbell(eJAhWAgXAxYBhWBgX","BxYChWCgXCfM,vYm=dist*aJqMAaGAqMBaGBqMCaGC;eFen;%20gCx;%20}%5c',","gN:{tpJ:[0.027oV14,0.1kZ597,0.716bZ508zR,1.434,1.6cW9lLtQ8,1.164",",0.97jU8,2.341,2.176,2.10yK78,1.70pRgT725sW6,0.948,0.94cW98,1.21","2,1.6,1.3tX6tX291],eIfR103,0.843yJ4,1.241,0.5mG524,0.603fS0.994y","J3,0.802,1.44,0iP549,0.656]hBBfR81bX25,1.532,0.44jU2sW,1.905]cZ[","2.558fN7,2.9gT062,1.578,2.82pR23,-1.747]eB[2.653,0.654,0.08,-0.6","86,1.221,0.875,2.956,-0.386]bR[0.252,0mM753sW4,1.115fNlL24,0.456",",1.06cW59,1.373,1.235,1iP12lLkZ337],peXfR669rN0.781,1.14qN5,1.32","5zRfN1,1.672,0.749,0.472,1.026,1.103,1.11,0.245yJ4dF6,-0.421,1.0","8fS1.2mG2kZ003,0.964,-0.284,0.595,0.522,0.582,0.615,0.136,1.324r","N1.593,-0.241,1mM149bZ779,0.538,0.546,0.558,1.337,0.939rO46,0.60","5,0.319,1.1kZ99rO8qN73,0.97pR77,0.61,0.331,0uN414,0.772,0.842,0.","907,1.027eN4tQ2fN],cVfR549dF3,0.63dF,1.094dF9,1.19bX04,0.5qN7jU1","7,1.3gT526,0.682,1.316,1.2gT89dF8,0.921tQbX92,1.451,0.787,0.4mG1","5jU3pR29,0.64,1uN084,0.994],pWsC04oV82,2.467,2.848,2.701,2.565,2",".742,2.50yK98,2.523,2.759,2.986,2.651,2.663,2.778,2.954,2.921,2.","97yK46,2.28oV43oV41,0.035oV61rO68rO27rO15rO84rO4oV86oV57oV82],mQ","sC37rO99,0.115dW8,0.175,0.1tX071oV39rO65oV82,0.034eN2,0.2eN7,0.4","16,0.33,0.152rO52oV9rO27oV76oV08rO44oV97,0.093rO05oV35oV13,0.101",",-0.337oV9]},aA:3,bgScF:43,pG:49,boT:0,boTRedjNboTcFjNhI:3,jTiEb","oTBluejNeI:20777448795248376,qIYiEqIXiEqIScale:0.46,eD:0.073,rQ:","0,xZ:36.673,rWqQtpJ:19.572,iT:0.83,taM:2.922,minuM:82bR719,vB:64",",xQ:0.25,tZ:0.027,kS:0.009,pK:10000,wA:7416062.555,mQ:1329344296","88.769,uI:0.114,vS:2054.072,cA:5043857086993475000,wH:0.023,paus","erDacS:0.4,lT:0.74,pUqQcCqQrFOuterCircleqQmFqQjPqQautoMoveTaMSli","derrDyLqQtNrDfXrDfreqA:48.477,ampA:19362.916hBB:4.827,ampB:38571","241074.056hBC:20.54,ampC:1407626.393,cV:0.056eB0.906dNAeP0.551dN","AfM:5569114229180370cZ-0.382dNBeP0.284dNBfM:195325250830335700dN","CiK:1.26dNCeP4.607dNCfM:117380873596.237,forceMaxResolutionqQstr","etchToWindowqQcgUElseSvgqQisEraseCgUEachFrameqQmK:49280.617,mKDi","stance:40.162,qF:1.27,cnT:9496740817046,pW:0.267,lineThick:1,peX",":0.999,hHqQname:%5c'GeneReef_S95E3_(mob)%20_small%5c',yC:[0,0,0.","5,-1.5,0,0],qI:%5c'a=>[%20sin(a+cos(a*2))/3,cos(a)/2%20]%5c',isO","nlyMoveRandomlyPerpendicularToSurfacerDpUBright:%5c'qR%5c',dir:%","5c'3%5c',tU:1.3}vFbuilder=falsevFseed=rZwS.of(0n)vFhG=sssmUrZ(ss","s)^iOvO;}vFfU=rYmUcI*iOn+0xBvOcXvV=(cI>>(48n-rZ(rY)));gCNnA(vV)|","0;}vFcRdXfU(31)/0x8pL00;%20aH%5c'Uses%20opensourceMIT%20Augmente","dBalls%5c')eUbUoqS%5c'opt%5c'eUzG%5c'jH%5c'vFtqZehU;wYbuboot(),b","Uoo={},oo.jH=o.jH,oo.gN=e(o.gN||{}),eval(%5c'aHJSON.stringify(oo","));%5c')vFnVBit={},vT={};sKosXe=o[t];cD=!1===e||!0===e,vT[t]=NnA",".isInteger(e),(cD||%5c'nnA%5c'qWe)&&(oeAo[t])}var%20idX56+200*cR","gEoQsvPrhZnhZhhZl=oo.aS,atHotoQr,n,h);if(s)fIldLa.lX[t]=l[t];gCa","},rdX{sKoo)o.aS?(aS||(xV.aSbB)),eAaS.yF()):eAoo[t]}mEroyHround,m","nyHmin,mxyHmax,sinyHsin,cosyHcos,wi=window,px=%5c'px%5c',flkM,cc","P,ndIFloatwS(t),h=t=>yUvFl=0,a=350,u=850,p=100,c=600,d=60mEf=0,v","=1,y=2,x=3vFbnEcG=vZcreatelV(%5c'cgU%5c'),kTqZsTqZlNqZgLfFqZt.ap","pendChild(cG)cXe=cGdOgH=10fG=10,e.position=%5c'absolute%5c',e.le","ft=%5c'0px%5c',e.top=%5c'0px%5c',e.zIndex=-nYqEjFt||(t=0),e||(ei","IWidth)),i||(i=0),s||(siIfM))cXr=e-t,n=s-i,h=cG,l=hdOnQ%5c'xL%5c","',n+px),nQ%5c'width%5c',r+px),l.xL=nlBwidth=rlBtop=ilBleft=t+px}",",gLoiD=cG.getContext(%5c'2d%5c'),sT=kT.gezO0,0jZ,gH)jZfG)),lN=sT",".data,gLfFtHm(lNfG,gH)},gLriD.puzOsT,0,0)},gLqE(0,10,0,10),gLoG(",")},mbM){gLb=t,gLh=e,gLw=i},g=mcXM=g.prototype;M.oDRGBAkKaI,n){mP","===n&&(n=255)cXhuG4*(ro(t)*gLw+ro(e)),gLbbB-4);vCf]=i,vCv]=s,vCy","]=r,vCx]=n}mEPwI2,38),w=16383,S=1<<24;yAYuWPxEuWSxEorReduT16rJcF","uT8rJBlue=(t=>255&t),wQ=((aI)=>((t&w)<<14|e&w)*S+((255&i)<<16|(2","55&s)<<8|255&r)),M.oDUkFvGyAY(t),i=yAX(t),spERed(t),rpEcF(t),npE","Blue(t);gLbJ(e,mC},MwLnEaC+)gLoDUkFyYM.ukFhXCwQoQi^dUf],s^dUv],r","^dUy])},M.bJhXLb[n+f]^=i,dUv]^=s,dUy]^=r,dUqX,MtFkKkP,asXu=s-e,p","=r-i,ciCu,p),dyHmJc),f=-1,v=-1,y=e,x=i;jOa;e++){jOdkUi=ro(y+u*e/","d),s=ro(x+p*e/d);i==f&&s==v||(t(gLukF(i,s,n,h,l)),f=i,v=s)}y+=p/","c,x+=u/c}}mEA=(aIvPh=n(i*r);aOn=0;n<i;n++)nWrsSlwRl+=t[n*s+h]*e[","h*r+i];h[n*r+i]=l}gCh}vFRuYt[0];aOi=1;i<tbB;i++)e*=t[i];gCe},CkK","t,e){if(gLsizes=t,e)if(%5c'function%5c'qWe){sU;fIlKdLgLmT=e()}nN","lK=e;nNsU};CgAgJnEgCiXbTmX],A(lK,t.arr,bTgLeG1],mX))}vFBuY[];gCe","tS...t),e},FoEvPs=t;fIedL{s=s.gJ(e[t]);fIs.arrdLs.mT=i(s.mT)}gCs","}mEuC=t=>.5+.5*nOtanh(.5*t)vFDuYt.eG0],i=mX,s=e-1;jOilJ.arr[s*i+","e]=e==i-1?100:0}mEXnHW=!WsXt=0,euQ;do{i=(twZt+(ewZe}while(i>=1||","0==i)cXsyG-2*nOlog(i)/i);gC_=t*s,e*s}gC_},O=(t,e)=>yV(t*t+e*e))d","NoE,s)=>i*yVsqr((s-t)/e)),V=t=>vRcR()*t)vFTyHtanh,G=5,I=1+2*G,N=","3,z=I*N+1,Y=N,EvUD(t)},UvUaC+)EyYk=[z,nOmJz),Y],LuJmEaJ=2*nOPI,J","mW%5c'eVtiming.navigationStart%5c'),qdX.001*(J+eVnow()),HoE)=>nL","vFW=!1,_=0mEj=t=>vZgetlVById(t)vFZ=h(1<<21),KnXHuVtbAs=HuVebAr=f","l(i)<<11|fl(s)<<1;uB{y:Z[r],x:Z[r+1]}},bWvUfIZdLZ[t]=0;aC=6)Q(t[","elE1lE2lE3lE4lE5])},Q=(aI,nvPh=ce(4*(256*isNttuVtfA,a=ttuVefA;aO","t=l-h;t<l+h;t++)aOe=a-h;e<a+hkUh=2097151&(t<<11|e<<1),u=h+1,p=(t","-lhQc=(e-ahQd=O(p,c),fdG+at,cgVvdG,c+atgVy=2.5;Z[hoAhsRr+f)*y,Z[","uoAusRn+v)*y}}cX$bM,uI,vS,tZ,rQ,s,r,l,a){if(!sqS%5c'no%20points%","5c'cXu=t,p=o.eI;gLdt=ecXc=ut,d=c.oLY,x=c.oLX,b=c.lX,m=b*o.tU;gLz","EgLkC=scXgwIcL2);if(e=mx(-.9,mn(e,.9)),gLypoUxpoUyvoUxvoUredlYlD","lYbHlYusXt=iX1,z]),n=u,a=u.pH(),plYc=h(s);fIsxXe=pF%25s,i=dAe]-d","At],r=sFe]-sFt],niCi,r);pwJ1:i/n,cwJ0:r/n}let%20bwR{dAh]=u.dV=vE","],h>0&&(b+iCu.yp[hCh-1],vE]-vE-1]));jOIkUi=(e+h-G+s)%25s;t.arr[3","*e+fpYoJv]=uzPoJyiZ[i]/127.5-1}xI=1cXM=F(t,r,l),PfBf]),wfBv]),Sf","By]),A=pXo.pW*e,1));hN[hpYvIP,lD[h]=uzPvIw,bH[hiZvIScXR=0,C=0,B=","e*o.wA,D=K(gLdV);RdEy,CdEx;fIn.kCxXe=dAhCt],s=sFh]-uzN,r=e*e+s*s","mVr&&r<=gsXe=t/n.kC*a,s=mn(kA-b),kA+a-bsNp[h],u=c[h],f=p[t],v=c[","t],yyGr),g=1-y/uI,MdZmDjDP=i(dAh]-at/2,sFh],n.yp[t]+at/2,nzNjDwd","Z-at/2mD+at/2jDS=(PeE,A=(weE;R+=S*B,C+=A*B}}let%20O=vS*qR(kA))mV","vSsXt=(h+1)%25s,e=dAt]-dAh],i=sFt]-sFh],riCe,i)mVrsXt=e/r,s=i/r,","n=s,h=-t,l=O*X();R+=n*l,C+=h*l}}gD=u.yv[h]+R,fV=u.xv[h]+CcXViCgD",",fV)mVVsXt=pXV-rQ*e,o.tZ)),i=t/V;gD*=i,fV*=i}dAh]+=gD*e,sFh]+=fV","*e,o.fX&&(fV=gD=0)}}hKtuQ,r=e*vS,n=0,qImWo.qIYX||o.qI);jOskUr=e/","s*aJ,h=cos(r),l=sin(r),a=qI(r);%5c'nnA%5c'qWa?xO*hmNa*l):xO[0]mN","a[1]),dAe]=t+o.qIYzHdAe]mNi+o.qIXzHsFe],gLysGh,gLxsGl,hNmBjY[e]=","V(256)}a||gLuFgEgLkC}}mEttoE)=>ro(nL)vFet=t=>ro(pXt,255)));$gAyL","kKsXtiAue],e=gLkC,i=gLpQgEi[e],r=H(mxtJ,e-o.vB),nOceil(s/o.kS),m","n(e+o.vB,o.maxuMsNs/r;gLypkDxpkDyvkDxvkDrediR,lDiR,bHiRcXaiAue];","gLkC=rcXu=0;aOs=0;s<r;s++sXr=s*l;for(;fK<r;)u++cXn=(u+1)%25e,h=f","K-i[u],p=(r-i[u])/h;aC+)a[e][s]=t[e][u]*(1-p)+p*t[e][n]}gCwYrFTe","xt(this),s}vFsqr=t=>t*t;$gAuFkYo.vB;o.vB=nYyL(),o.vB=tuOpHkYgLpQ","();gCxIuOpQkYgLkC,e=npF;e[0]=0;nWtsSbV%25t,riCdAs]-dAi],sFs]-sFi","]);e[i+1]=e[i]+r}gCeuOcQjFbOgLkC;r++)dAr]=H(i,dAr],s),sFr]=H(t,s","Fr],e)}vFithU,otkKname,t,e,i,s){gLclicks=[],gLname=name,kX=yUcXr","=.7+.6*cR(aT;kX[e]=1+.3*(jL5*i*r)+jL7*i*r+.3))}hN=e,lD=i,bH=s,iH","qZcGLabeluJ};otgAyFkYoocK*kbL(l);gCnVBitcK?0<t:vTcK?nOround(t)||","1:t||atoYlbLvGt/aJ*kXbB;(e%25zZ<0&&(e+zZcXikM(e),bV%25kXbB,r=e-i",";gCkX[vRi)]*(1-r)+r*kX[s]oYoIkYkXbB;iH||(iH=dt(t)aT-l,s=cOOfZero","uP+cOMul*kX[e];iH.xlZsinbCylZcosbCred[e]=hN,iHzPmB,iH.bluejY}}vF","st=(e,mC=>{sKgNsXn=aS;wD&&nvJ,wD=(wD||0)+1}aOh%20in%20gN)if(!n||","h==tsXt=gN[h];t.oI(),t.curve.zEtvJ}},rtbM,s,vS){iHs=t,gLtP=e,gLc","M=i,gLvW=s,gLvSuJ};rtgAtpJkY0;jOiHsbBlJ+=iHs[e].dt;gCt}vFntnX0,s","=e-t;if(s>0)i+=s*s*o.cA;else{i+=10*(hE*(e/t))-hE))}gCi},jHmWo.jH",")eUjHqS%5c'jH=%5c'+jHvFht=(kP,gRvPdiCi-t,s-e),en=0eUo.tN){o.wHcX","riCt-a,e-u);nOhypot(i-a,s-u);en=kV+kV}gCen=jH(en,d,c)},at=1e-6,u","t={oLY:0,oLX:0,lX:1},ptdX-.1+X(),csL[];jOkbB-1lJtSiXk[e],k[e+1]]",",pt));gCU(t),t},dtdI$(mP,at,ht,cL0aBt,ct(),T,!0),fsLct();gCnew%2","0rt([dttJ)],ht,t,T,null)},vtdX{uUwYclearLoops()},gN={},ytdX{adju","stBordersOfuPs(oo)},xtnHwY(putInDefaults(oo),o=e(oo)),!zG%5c'no%","20jH%5c';hG(oo.cnT),l=0,vt(),mt=[ft()];sKoo.gN)xVo.aSbB,!0);o.yC","&&bW(o.yC),wY(t=gN.tpJ?%5c'tpJ%5c':null,j(%5c'qIEditor%5c').valu","e=o.qI)},bt=0,mt=[],MtdXmt[0],Pt=q(),weQ,e=q(),iuGe-Pt,.1);l+=2*","i*nOPI/o.xZ,(l%25=aJ)<0&&(l+=aJ),r()cXs=0hMrWsXe=o.tpJ-t.tpJ();s","uGo.iT,1)*i*e}nNs=i*o.taM;s*uGoo.qF,1),Pt=e,d=d*(1-i)+1cXn=s<0,h","=s,a=s;for(hPn&&(bt=0);bt<cNbB-3&&hPs<0;)bt++,h=a,a=s,s+oPgYbt].","dt)cXu=gY1-bt]hMjP&&(s=mx(0,s)),!u)uBcXp=u.kCmVssXetH$(u,s,t.tP,","cLo.vSaBp,t.cM,t.vW);o.yL&&e.yL()cXi=1/(1-H(0,o.xQ,.95));e.cQ(-i",",i,-i,i),cNtSe)}cNbB>o.pK&&(cN=cN.slice(-o.pK))},St=(kPvPa=e.wOb","B>0,u=t&&!a,p=t,c=e.kC,d=0,f=t=>e.wOtSt);fIcxXa=pF%25c,paVt]),vo","Ct]),yaVa]),xoCa]),b=y-p,m=x-v;d=mx(d,m*m+b*b)cXg=o.jT,M=o.hI,P=","(e.redwERed+M,w=(ezPwEcF+M,S=(e.bluewEBlue+M;o.hH||(P=et(P),w=et","(w),S=et(S)),u&&itF(f,v,p,x,y,P,w,S,l)}p&&iwL(e.wO)},uUCtqZBeQvF","e=j(%5c'aDiv%5c');gY1];p=0,a=0,c=pVfM,u=pVWidthcXi=(c+p)/2,s=(u+","a)/2,roP(1-o.xQ)*mn(c-p,u-a)/2),n=r,h=i+%5c'_%5c'+s+%5c'_%5c'+r+","%5c'_%5c'+n;Ct!=h&&setTimeoutpZRt=At=!0},200),Ct=h,wY%5c'%5c'!=s","Q&&(sQ=%5c'%5c')cXl=At;a+10<u&&p+10<c&&L.qE(gR)cXwV;!At&&o.cC||(","ApNL.oG(),wV);aOt=x;t<L.fFbB;t+=4)d[t]=255eUlsXe=Rt||!o.cC;if(Rp","Ne)if(bUwM)wM(o.aA,o.bgScF,o.pG,o.boT,ZkO0,1024,L.fF,fl(inZi+2*r","),fl(snZs+2*n));hKt=d.b,etDRed),itDcF),stDBlue);bOtbB;r+=4)t[r+f","]=etLv]=itLy]=stLqXlet%20h=o.mF,liQif(hqB){for(;cNbB>2qB;sXeiQSt","(h,elRbt--}bt=0}cNtSl),St(h,llRwYchkwF&&tryDispOutCirc(mC}wYbldD","isp(mC,L.rG()},FpNDt=0,XtdX{Dt++vFt=!0hMpause||o.qF<=0)t=!1;hKcP","(1/o.qF);t=Dt%25e==0}t&&(wt(),Bt()),requestAnimationFrame(Xt)},O","tuJ;wi.onload=pZFt=!0,wYbootwF,Ot=j(%5c'divabxy%5c'),L||(LtHb(Ot",")),xt(),Xt()});';let%20replace='this.@gL@for(let%20@aO@=function","(@kK@maxNumPointsPerCurveChangeAtOnce@vB@maxDistanceToAffectEach","other@uI@.length@bB@pseudorandomFraction@cR@){let%20@sX@rightMul","t@oT@imePosition@pJ@balanceSparsity@yL@bootShape@qI@.prototype.@","gA@addRandomness@vS@return%20@gC@ttractIfFartherThan@cS@=Math.@y","H@t.curves@cN@[t]*(1-g)+255*g)*o.paintBoT*o.boT@wE@midDist*p.bel","l@eJ@PointsPerCurve@uM@ndoable2dVoxel@kF@aOe=0;e<@jO@numPoints@k","C@)=>{let%20@vP@rightAdd@gS@gLradius@kX@builder&&@wY@t,e,i,s,r@a","I@undoableVoxels@wO@accelFieldMul@eI@Math.floor(@vR@=et(127.5+12","7.5*M.arr[@fB@g.voxel@yA@targetDistanceBetweenAdjacentCurvePoint","s@kS@kKaIsXn=H(0,4*(vRt)*gLw+vRe)),gLbbB-4);g@hX@=[gLyp,gLxp,gLy","v,gLxv,gLred,gLgreen,gLbl@iA@otentialEnergyF@aY@negTimeDoesUndo@","jP@loops[t]@aS@,L.byteRect,i,s,r,n,mx(1,o.lineThick)),@lR@,l,u,f",",v,d,x,m,s)*g,@jD@gLcurve@iH@;%20x%20+=%20sin(m*p.freq@qM@aOt=0;","t<@fI@yHhypot(@iC@;let%20@cX@perimeterDistances@pQ@yp[h],gLxp[h]","@dV@=t=>JSON.parse(JSON.stringify(t))@hU@ampStraightIfNear@mQ@se","tSpeedsToZeroAfterEveryDtMove@fX@endist@jH@;const%20@mE@optionIs","@nV@computeSpeed@qF@colorDecayPerSec@pW@maxCurvesPerReef@pK@.str","eamUkFsForLineYXYXRGBSafe@tF@;var%20@vF@:true,@qQ@stayInsideBord","erCircleForce@cA@gLimageData@sT@(0,512+256*@uV@Height,dist);%20x","%20+=%20bell(eJ@xY@);jOt;e++sXi=2*Math.PI*e/t@aT@byteRect@fF@wri","teSafe@oD@borderFraction@xQ@sliderOrCheckboxValueNow@yF@.paintOr","Unpaint(e,i,s,r)@vJ@:[1.088,1.@fR@DevMul,p.bell@gX@,gLdom.height","@fG@n.countPaints@wD@ifCanvasUseUndoGraphics@mF@,o.maxSpeed,o.fr","iction,@aB@[i]/127.5-1,t.arr[3*e+@oJ@copyRadiusArrayToCurve@oI@,","-0.0@oV@Math.@nO@resizeCanvas@qE@[h]*(1-A)+A*@vI@gLyp[@dA@gLgree","n@lD@gLcontext@kT@gLxp[@sF@AveMul@iK@new%20Float32Array(t)@yU@ac","celVoxels@yC@gLdom.width@gH@beforePaint@oG@=t=>{let%20e=@uY@,-0.","1@rO@=null,@qZ@sizes[@eG@:false,@rD@bB;t++)@dL@kKt,e,i@bM@;if(0!","=@mV@gLyv[h]@gD@gLxv[h]@fV@n)&((1n<<48n)-1n)@vO@=0;aOh=0;h<s;h++",")@wR@olorSeed@nT@wi.inner@pV@i,s,r,n)@mC@jOtbB;e+@aC@=n(s),gL@oU","@=n(r),gL@kD@,bell@dN@pseudorandomNext@fU@,n.yp[t],n.xp[t]@mD@=(",")=>@dX@borderRadiusMul@tU@h.setAttribute(@nQ@paintAccelField@wM@","Height@fM@gLb[n+@dU@gLblue@bH@kKsXt=@kY@isSurface@cC@nVInteger@v","T@==typeof%20@qW@else{let%20@hK@=et(o.bgS@tD@window.@bU@sigmoid@","uC@midDist@cV@aintBoT@eX@seed[0]@cI@aOt%20in%20@sK@=(t,e,i@oE@t=","(vPt=@sL@sameColorness@jT@distanceScale@wH@gLarr=h(R(t))@sU@mx(t",",mn(e,i))@nL@neuralWeights@cM@=ro(r+h*e.xp[@aV@=ro(s+n*e.yp[@oC@","loops@gN@;%20let%20@mS@)throw@qS@.push(@tS@],t[e+@lE@friction@rQ","@imeSpeed@aM@maxSpeed@tZ@gLpixels@lN@aI,n,h,l@kP@mx(0,mn(@pX@[gL","name]@cK@cN[cNbB-@gY@scalePaYorce@wA@console.log(@aH@.paintVoxel","s@wL@performance.@eV@At=!0,Rt=!0,@uU@loopSeconds@xZ@graphEndist@","pU@0x5DEECE66D@iO@tImageData(@zO@&255),yAXor@rJ@yAYXXorsRGB@wQ@=","2*cR()-1)*@wZ@+=o.eI*B*D.@dE@+o.qIScale*@zH@e.innerHTML@sQ@Green","@cF@%20x%20+=%20@eF@radius@lX@gLb[h+@vC@;e++sX@kU@center@oL@=h(s","),@lY@.green@zP@)*p.amp@aG@DevMul:@eP@new%20C([@iX@nOabs(e@kA@*s","qr(dist-@pT@onlyEndist@tN@afterPaint@rG@=(t=>fl(t/@uW@nOexp(-.5*","@yV@,1023.99),@bA@]yHtanh(Z[@oA@holdInRect@cQ@loopRadius@cO@neur","alFunc@vW@=cN.pop();@iQ@twoPi@aJ@gLdom@cG@nearPdist@eD@,0.837,0.","@bZ@,0.18,0.1@dW@repelSelf@mK@bits1To32@rY@document.@vZ@=mx(10,p","V@iI@ceil(1.5*@mJ@=(t,evPi=@nX@=-s*((O(p@dG@)-d)/at),@gV@perimet","er@pH@[t]=0==n?@wJ@(i)*s,iH.@bC@-2*n),fl(@nZ@Builder()@wF@,0.98@","dF@;if(!@eU@:1.01,@jN@:0.01,@iE@BigInt@rZ@+px,l.@lB@=yAXor@pE@ar","r[t]@mT@t.eG1]@mX@;e++)t@lJ@=eval(@mW@;t++sX@xX@u.xp[h@vE@,sFe]=","@mN@;if(o.@hM@paintBgS@hI@tpJDecay@iT@nVBit[t]@cD@aS=s(t,o@xV@=t","=>new%20@dI@)&w),yAX@xE@=(t=>t>>@uT@oDXorRGB@bJ@(t[e])},@yY@aOi=","0;i<@nW@putHills@bW@)/256/i,@hQ@h]-u.yp[@hC@]=u.blue@iZ@t[tbB-1]","@xI@(o.minuM@tJ@aOr=0;r<@bO@XAtAngle@bL@,0,1024,@kO@28,0.@kZ@6,1",".5@jU@5,0.9@pR@12,0.@gT@,0.62@fN@umber@nA@=new%20@tH@=H(0,@uG@=n","ull@uJ@gLred@hN@dist)mS@vY@,1.169,@fS@.409,1.@iP@,maxuM:@bR@.263",",0.@mM@,1.527,@rN@.008,1.@uN@bgSBlue@pG@display@rF@wrapPeX@hH@64","Array@wS@=>{cI=(@mU@retLong@vV@yHfloor@kM@eyHceil@cP@Element@lV@",".style;@dO@GkK){kT@iD@kKtsXe=@vG@x]=255}@qX@gLeG0],@bT@yHsqrt(@y","G@]=u.red@pY@=i(gLdV@dZ@(dAe]=a@xO@v[e]=n*@sG@s=(i+1)@bV@uC(.001","@hE@a,u,p,c@gR@nt(p,r)@kV@iK,eJ@hW@9,0.8@cW@3,0.3@lL@,0.76@tQ@7,","2.5@yK@,0.79@sW@94,0.@tX@,1.01@yJ@33,1.@mG@,freq@hB@5,1.1@bX@8,0",".7@qN@,0.20@eN@anvas@gU@00000@pL@o[t]=@eA@(),s=@gE@(t,e,@oQ@=i()",",@hZ@kKt){@nE@gLarr@lK@else%20@nN@=t=>{@vU@)),l=@sN@o.uI,@cL@(t+","1)@pF@=h(r)@iR@},$gA@uO@t=!1,@pN@,t[r+@tL@o.acS)@qG@ampAcS@lT@,0",".216@zR@dNBiK:@cZ@dNAiK:@eB@:[-0.0@sC@bgSRed@aA@useTpJ@rW@nOsqrt","@qR@setCnT@hG@o.jHqS@zG@1e6,gL@nY@bM,s){@jF@height@xL@,mx(10@jZ@","void%200@mP@yHpow(@wI@;i++sX@sS@matmul@gJ@dX{if(@nH@=0,i=0@uQ@re","turn@uB@,1023)@fA@]/y+d*@sR@wO=[],@zE@.xp[t]@zN@-M)/at@eE@[e]=lD","@mB@[e]=bH@jY@yLBoot@uF@i[u+1]@fK@nOsin(@jL@},otgA@oY@=kXbB)@zZ@","Option@uP@p[e]yH@lZ@paYunc@tP@sLMt()@eQ@o.jP&&@hP@yHabs(@oP@(()=",">{@pZ@d=L.fF@wV@&&bt>0@qB'.split('@');for(let%20i=replace.length","-2;%20i>=0;%20i-=2)%20code%20=%20code.split(replace[i+1]).join(r","eplace[i]);console.log(code);eval(code);</script></head><body%20","style='background-color:black;color:white;user-select:none'><div","%20id=divabxy%20style='background-color:black;color:white;width:","0px;height:0px'></div></body></html>"]}],"geneReefId":"934","image":"ipfs://QmdBYWqvXrsR4D36aGAb2sja8fTcY4nyCnnKJJFGYjUTSn","mediaType":"image/jpeg","species":"95","startingShape":"22"}},"version":"1.0"}}
*/
public class ReefMetadataTransformer{
	
	public static String findWhatsBetween(String metadata, String prefix, String suffix){
		int i = metadata.indexOf(prefix);
		if(i == -1) throw new RuntimeException("Not found: "+prefix);
		i += prefix.length();
		int j = metadata.indexOf(suffix, i);
		if(j == -1) throw new RuntimeException("Not found (after prefix): "+suffix);
		return metadata.substring(i,j);
	}
	
	//returns new metadata
	public static String replaceWhatsBetween(String metadata, String prefix, String suffix, String replacement){
		int i = metadata.indexOf(prefix);
		if(i == -1) throw new RuntimeException("Not found: "+prefix);
		i += prefix.length();
		int j = metadata.indexOf(suffix, i);
		if(j == -1) throw new RuntimeException("Not found (after prefix): "+suffix);
		return metadata.substring(0,i)+replacement+metadata.substring(j);
	}
	
	/** Example filename:  GeneReef_S95E3_(mob) _small.cardanoPROBABLYFITS.json
	Example output filename: GeneReef0934.metadata
	 */
	public static void onInputFile(File in){
		System.out.println("Reading file "+in);
		String metadata = Text.bytesToStr(Files.read(in));
		String geneReefNumber0001To8888AsString = findWhatsBetween(metadata,"\":{\"GeneReef","\":{\"backgroundColor\":");
		String filenameOut = "GeneReef"+geneReefNumber0001To8888AsString+".metadata";
		File out = new File(in.getParentFile(),filenameOut);
		if(metadata.contains("\"description\"")) throw new RuntimeException("Already contains description");
		String insertDescriptionKeyValBefore = ",\"files\":[{\"mediaType\":"; //,"files":[{"mediaType":
		int i = metadata.indexOf(insertDescriptionKeyValBefore);
		if(i == -1) throw new RuntimeException("insertDescriptionKeyValBefore not found: "+insertDescriptionKeyValBefore);
		//Genereefs is a collection of 8,888 Corals growing, evolving, & fully stored on the Cardano Blockchain.
		//Genereefs is a collection of 8888 Corals, fully stored on #Cardano, growing, energy func simulated, & some evolved.
		//GeneReefs is a collection of 8888 Corals growing, evolving, fully stored on the Cardano Blockchain.
		//description might be limited to 100 chars, at least on nft-maker.io if you use their template (which we probably wont).
		String description = "GeneReefs is a collection of 8888 Corals growing, evolving, fully stored on the Cardano Blockchain.";
		if(description.length() > 100) throw new RuntimeException("Is description too big?");
		//WARNING: if description has string escapes, this will generate invalid json.
		metadata = metadata.substring(0,i)+",\"description\":\""+description+"\""+metadata.substring(i);
		byte[] outBytes = Text.stringToBytes(metadata);
		System.out.println("Writing "+outBytes.length+" bytes to file "+out);
		Files.write(outBytes, out);
	}
	
	public static void main(String[] args){
		//onInputFile(new File("S:\\q\\temp\\reef705\\reefsOut\\GeneReef_S294E43_glowalizer.cardanoPROBABLYFITS.json"));
		int count = 0;
		for(File file : new File("S:\\q\\temp\\reef705\\reefsOut").listFiles()){
			if(file.getName().endsWith(".cardanoPROBABLYFITS.json")){
				onInputFile(file);
				count++;
				//if(count > 100) break;
			}
		}
	}
	
	//":{"backgroundColor":
	
	/*public static String transformCardanoMetadata(String metadata){
		String geneReefNumber0001To8888AsString = 
	}*/

}
